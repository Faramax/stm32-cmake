SET(STM32_CMAKE_XXX_COMPILER_FLAGS "-mthumb -mcpu=cortex-m3")
SET(STM32_CMAKE_XXX_LINKER_FLAGS "-mthumb -mcpu=cortex-m3")

SET(STM32_CHIP_TYPE_REGEXP "2[01][57][RVZI][BCEFG]")
SET(STM32_CHIP_TYPES 205xx 207xx 215xx 217xx CACHE INTERNAL "stm32f2 chip types")
SET(STM32_CODES 205.. 207.. 215.. 217..)

MACRO(STM32_GET_CHIP_PARAMETERS CHIP FLASH_SIZE RAM_SIZE)
    STRING(REGEX REPLACE "^[sS][tT][mM]32[fF](2[01][57]..)" "\\1" STM32_CODE ${CHIP})
    STRING(REGEX REPLACE "^[sS][tT][mM]32[fF]2[01][57].(.)" "\\1" STM32_SIZE_CODE ${CHIP})

    STM32FX_GET_CHIP_FLASH_SIZE(${STM32_SIZE_CODE} ${FLASH_SIZE})
    
    IF(${STM32_CODE} MATCHES 205.B)
        SET(RAM "64K")
    ELSEIF(${STM32_CODE} MATCHES 205.C)
        SET(RAM "96K")
    ELSE()
        SET(RAM "128K")
    ENDIF()
    
    SET(${RAM_SIZE} ${RAM})
ENDMACRO()
