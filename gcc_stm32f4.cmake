SET(STM32_CMAKE_XXX_COMPILER_FLAGS "-mthumb -mcpu=cortex-m4")
SET(STM32_CMAKE_CXX_COMPILER_FLAGS "-mfpu=fpv4-sp-d16 -mfloat-abi=hard")
SET(STM32_CMAKE_XXX_LINKER_FLAGS "-mthumb -mcpu=cortex-m4 -mfpu=fpv4-sp-d16 -mfloat-abi=hard")

SET(STM32_CHIP_TYPE_REGEXP "4[0123][1579].[BCEGI]")
SET(STM32_CHIP_TYPES 401xx 40_41xxx 427_437xx 429_439xx CACHE INTERNAL "stm32f4 chip types")
SET(STM32_CODES "401.[BC]" "4[01][57].[EG]" "4[23]7.[EGI]" "4[23]9.[EGI]")

MACRO(STM32_GET_CHIP_PARAMETERS CHIP FLASH_SIZE RAM_SIZE)
    STRING(REGEX REPLACE "^[sS][tT][mM]32[fF](4[0123][1579].[BCEGI])" "\\1" STM32_CODE ${CHIP})
    STRING(REGEX REPLACE "^[sS][tT][mM]32[fF]4[0123][1579].([BCEGI])" "\\1" STM32_SIZE_CODE ${CHIP})

    STM32FX_GET_CHIP_FLASH_SIZE(${STM32_SIZE_CODE} ${FLASH_SIZE})
    
    STM32_GET_CHIP_TYPE(${CHIP} TYPE)
    
    IF(${TYPE} STREQUAL "401xx")
        SET(RAM "64K")
    ELSEIF(${TYPE} STREQUAL "40_41xxx")
        SET(RAM "128K")
    ELSEIF(${TYPE} STREQUAL "427_437xx")
        SET(RAM "192K")
    ELSEIF(${TYPE} STREQUAL "429_439xx")
        SET(RAM "192K")
    ENDIF()
    
    SET(${RAM_SIZE} ${RAM})
ENDMACRO()
